// Backbone.PickySitter, v0.1.0
// Copyright (c)2012 Jeremy McLeod, Isochronous.org
// Distributed under MIT license
// Heavily, heavily based on Backbone.Picky by Derick Bailey// http://github.com/derickbailey/backbone.picky
(function(e,t){typeof define=="function"&&define.amd&&define(["underscore","backbone"],t)})(this,function(e,t){return t.PickySitter=function(e,t){var n={};n.SingleSelect=function(e){this.container=e},t.extend(n.SingleSelect.prototype,{select:function(e){e=i(this.container,e);if(e&&this.selected===e)return;this.deselect(),this.selected=e,this.selected.select(),this.trigger("selected",e)},deselect:function(e){e=i(this.container,e);if(!this.selected)return;e=e||this.selected;if(this.selected!==e)return;this.selected.deselect(),this.trigger("deselected",this.selected),delete this.selected},getSelected:function(){return this.selected||!1}}),n.MultiSelect=function(e){this.container=e,this.selected={}},t.extend(n.MultiSelect.prototype,{select:function(e){e=i(this.container,e);if(this.selected[e.cid])return;this.selected[e.cid]=e,e.select(),r(this)},deselect:function(e){e=i(this.container,e);if(!this.selected[e.cid])return;delete this.selected[e.cid],e.deselect(),r(this)},selectAll:function(){this.each(function(e){e.select()}),r(this)},selectNone:function(){if(this.selectedLength===0)return;this.each(function(e){e.deselect()}),r(this)},toggleSelectAll:function(){this.selectedLength===this.length?this.selectNone():this.selectAll()},getSelected:function(){return this.selectedLength===this.length?!1:this.container.where(function(e){return e.selected===!0})}}),n.Selectable=function(e){this.view=e},t.extend(n.Selectable.prototype,{select:function(){if(this.selected)return;this.selected=!0,this.trigger("selected"),this.container&&this.container.select(this)},deselect:function(){if(!this.selected)return;this.selected=!1,this.trigger("deselected"),this.container&&this.container.deselect(this)},toggleSelected:function(){this.selected?this.deselect():this.select()}});var r=function(e){e.selectedLength=t.size(e.selected);var n=e.selectedLength,r=e.length;if(n===r){e.trigger("select:all",e);return}if(n===0){e.trigger("select:none",e);return}if(n>0&&n<r){e.trigger("select:some",e);return}},i=function(n,r){return r instanceof e.View||r.render&&r.el?r:r instanceof e.Model||r.attributes&&r.toJSON&&r.fetch?n.findByModel(r):r instanceof e.Collection||r.models&&r.toJSON&&r.getByCid?n.findByCollection(r):t.isNumber(r)?n.findByIndex(r):t.isString(r)?n.findByCustom(r)||n.findByCid(r):!1};return n}(t,e),t.PickySitter});